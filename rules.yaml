version: "1.0"
ruleset_id: "m87-default-v1"
description: "M87 Studio default audit rules"

SPOT:
  description: "Security Prevention & Output Tracking"
  rules:
    - id: SPOT-001
      name: No eval/exec
      description: "Forbids eval(), exec(), and compile() calls in any context"
      severity: critical
    - id: SPOT-002
      name: No hardcoded secrets
      description: "No string literals matching secret/key/password/token patterns"
      severity: critical
    - id: SPOT-003
      name: No shell injection
      description: "os.system(), subprocess calls must not use string formatting or f-strings for command construction"
      severity: critical
    - id: SPOT-004
      name: No pickle on untrusted input
      description: "pickle.loads() must not be called on user-supplied or externally sourced data"
      severity: high
    - id: SPOT-005
      name: No unvalidated redirect
      description: "HTTP redirects must not use unvalidated user input as the redirect target"
      severity: high

FORT:
  description: "Framework-Oriented Runtime Trust"
  rules:
    - id: FORT-001
      name: Function complexity
      description: "Functions must not exceed 50 statements"
      severity: medium
    - id: FORT-002
      name: No global mutation
      description: "Functions must not mutate module-level state"
      severity: medium
    - id: FORT-003
      name: No bare except
      description: "except clauses must specify an exception type â€” bare except: is forbidden"
      severity: medium
    - id: FORT-004
      name: Return type annotations required
      description: "Public functions must have return type annotations"
      severity: low
    - id: FORT-005
      name: No wildcard imports
      description: "from module import * is forbidden"
      severity: low
